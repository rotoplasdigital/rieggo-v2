<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Icon -->
		<link rel="icon" href="/resources/favicon.ico">
		<!-- Title -->
		<title>Sistemas de riego ideales para tu cultivo  |  Pilotos de tecnología</title>
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<link rel="stylesheet" href="../../css/rieggo.css">
		<!-- Js -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	</head>
	<body>
		<!-- Contenidos -->
		<div class="container-fluid">
			<!-- head -->
			<div class="row mt-3 p-0 justify-content-between align-items-center | m-lg-3 p-lg-3">
				<div class="col-6">
					<img src="../../resources/rieggo-logo.svg" alt="rieggo" width="150">
				</div>
				<div class="col-6 text-end">
					<a class="text-decoration-none bold" href="https://rieggo.com/" style="color:#002554;">
						ir al sitio web&nbsp;&nbsp;<img src="../../resources/images/tarjeta-digital/flecha.svg" alt="->" height="15">
					</a>
				</div>
			</div>
			<!-- form -->
			<div class="row my-3 py-3 justify-content-center">
				<div class="col-12 col-md-10 col-lg-6">
					<form id="form-pilotos-tecnologia" class="needs-validation mt-3 pt-3">
						<input type="hidden" name="fecha" id="fecha">
						<input type="hidden" name="hora" id="hora">
						<div class="mb-3">
							<label for="nombre" class="form-label">Nombre <span>*</span></label>
							<input type="text" class="form-control" id="nombre" name="nombre" required>
						</div>
						<div class="mb-3">
							<label for="apellido" class="form-label">Apellido <span>*</span></label>
							<input type="text" class="form-control" id="apellido" name="apellido" required>
						</div>
						<div class="mb-3">
							<label for="correo" class="form-label">Correo electrónico <span>*</span></label>
							<input type="email" class="form-control" id="correo" name="correo" required>
							<div id="email-alert"></div>
						</div>
						<div class="mb-3">
							<label for="telefono" class="form-label">Teléfono / Celular <span>*</span></label>
							<input type="number" class="form-control" id="telefono" name="telefono" required>
						</div>
						<div class="mb-3">
							<label for="hectareas" class="form-label">Cantidad de hectáreas <span>*</span></label>
							<input type="number" class="form-control" id="hectareas" name="hectareas" required>
						</div>
						<div class="mb-3">
							<label for="cultivo" class="form-label">Cultivo <span>*</span></label>
							<input type="text" class="form-control" id="cultivo" name="cultivo" required>
						</div>
						<div class="mb-3">
							<label for="condicion-cultivo" class="form-label">Condición del cultivo <span>*</span></label>
							<input type="text" class="form-control" id="condicion-cultivo" name="condicion-cultivo" required>
						</div>
						<div class="mb-3">
							<label for="puesto" class="form-label">Puesto</label>
							<input type="text" class="form-control" id="puesto" name="puesto">
						</div>
						<div class="mb-3">
							<label class="form-label">¿Tiene sistema de riego presurizado? <span>*</span></label>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="sistema-riego-presurizado" id="sistema-riego-presurizado-si" value="si" required>
								<label class="form-check-label" for="sistema-riego-presurizado-si">
									Si
								</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="sistema-riego-presurizado" id="sistema-riego-presurizado-no" value="no" required>
								<label class="form-check-label" for="sistema-riego-presurizado-no">
									No
								</label>
							</div>
						</div>
						
						<div class="mb-3">
							<label for="siguiente-ciclo" class="form-label">¿Cuándo inicia su siguiente ciclo?</label>
							<input type="text" class="form-control" id="siguiente-ciclo" name="siguiente-ciclo">
						</div>
						<div class="mb-3">
							<label for="fecha-capacitacion" class="form-label">Fecha acordada para capacitación</label>
							<input type="text" class="form-control" id="fecha-capacitacion" name="fecha-capacitacion">
						</div>
						<div class="mb-3">
							<button type="submit" class="btn btn-primary">Enviar</button>
						</div>
					</form>

					<div id="form-sucess-alert"></div>
				</div>
			</div>
		</div>
		<!-- Boostrap Js -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
		<script src="../../js/rieggo.js"></script>
		<script src="../../js/smooth-scrolling.js"></script>
		<script src="../../js/formtosheets.js"></script>
		<script>
			// fecha y hora
			const t = new Date()
			const date = ('0' + t.getDate()).slice(-2)
			const month = ('0' + (t.getMonth() + 1)).slice(-2)
			const year = t.getFullYear()
			const hours = ('0' + t.getHours()).slice(-2)
			const minutes = ('0' + t.getMinutes()).slice(-2)
			const seconds = ('0' + t.getSeconds()).slice(-2)
			const fecha = `${date}/${month}/${year}`
			const hora = `${hours}:${minutes}:${seconds}`
			document.getElementById('fecha').value = fecha
			document.getElementById('hora').value = hora
			// formulario
			const formulario = document.getElementById('form-pilotos-tecnologia');
			formulario.addEventListener('submit', function(e){
				// se previene el submit
				e.preventDefault()
				// declaramos el formulario como los datos a enviar
				const data = new FormData(document.getElementById('form-pilotos-tecnologia'))
				// fetch al process de donde se hace la llamada a la api de zerobounce
				fetch('process.php', {
					method: 'post',
					body: data
				})
				.then(function(response) {
					console.log('response: ' + response.body)
					if(response.ok) {
						return response.json()
					} else {
						throw "Error en la llamada Ajax";
					}
				})
				.then(function(json) {
					//console.log('status: ' + json.status)
					//console.log('sub status: ' + json.sub_status)
					contenedor = document.getElementById('email-alert')
					//verificamos si el valido el correo
					if(json.status == 'invalid' || json.substatus == 'mailbox_not_found' || json.sub_status =='failed_syntax_check') {
						//console.log('correo:invalido')
						contenedor.innerHTML = `<div class="alert alert-danger mt-2" role="alert">Ingresa un correo valido ejemplo@dominio.extension</div>`
						alert('Ingresa un correo valido ejemplo@dominio.extension')
					} else {
						// si es valido hacemos fetch a google sheets para hacer el registro de los datos
						if (contenedor.innerHTML.length > 0) {
							contenedor.innerHTML = ''
						}
						// Registro en Google Sheets
						fetch('https://script.google.com/macros/s/AKfycbwV43jso0mKES8buwB0a5LA6rq0TU6wsoTSblRRxBia0L8l0Za08tMH8O3GP5VFQUM1/exec', {
							method: 'post',
							body: data
						})
						.then(function(response){
							console.log('Success!', response)
						})
						.then(function() {
							// formulario reset
							document.getElementById("form-pilotos-tecnologia").reset()
							contenedor = document.getElementById('form-sucess-alert')
							contenedor.innerHTML = `<div class="alert alert-success mt-2" role="alert">Gracias por contactarnos, pronto un ejecutivo se pondrá en contacto contigo.</div>`
						})
						.catch(error => console.error('Error!', error.message))
					}
				})
				.catch(function(err) {
					console.log(err);
				})
			})
		</script>
	</body>
</html>